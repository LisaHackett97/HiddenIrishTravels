{% extends "base.html" %}
{% block content %}

<h1 class="center-align"> {{ username }}'s' Recommendations</h1>

<p>If you are new to our site, and haven't yet uploaded anything, this page will look a little blank.
    Dont worry, you can select Add New from the recommendation menu, add something in there.
    This will then appear below. Where you can edit or delete, or just view what you have uploaded. <br>
    Please go to our home page, to see all user receommendations</p>

    <div class="row center-align">
        <button id="home-search-button"><i class="fas fa-search"></i></button>
    </div>
    
    
    <div class="container search-container">
        <div class="row card-panel search-card">
            <form action="{{ url_for('search') }}" method="POST" class="col s12">
    
                <div class="row valign-wrapper center-align">
                    <!-- <div class="row"> -->
                    <div class="input-field col s8" id="search-input">
                        <input type="text" name="query" id="query" required class="validate">
                        <label for="query">Search here</label>
                    </div>
                    <div class="row">
                        <div class="col s12">
                            <button type="submit" class="btn-small text-shadow center search-action-btn">
                                <i class="fas fa-search left hide-on-small-only"></i> Search
                            </button>
                            <hr>
                            <button id="home-hide-button" class="btn-small"><i class="fas fa-times-circle"></i></button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    

<!-- Card to show search results and all the users uploaded recommendations -->
<div class="card-panel">  
    {% if recommendations|length > 0 %}
    <div class="container-fluid">
        <div class="row recommendation-row">
            {% for recommendation in recommendations %}
                {% if session.user|lower == recommendation.created_by|lower %}
                <div class="col s12">
                    <div class="card">
                        <div class="card-image">
                            <img src="#" alt="image to be inserted" class="activator">
                        </div>
                        <div class="card-content" id="user-card-content">
                            <h5 id="recommend-title"> {{recommendation.title}}</h5>
                            <p> <i class="fas fa-location-arrow"></i> {{ recommendation.location_name }} </p>
                            <p> <i class="fas fa-user-tag"> </i> {{ recommendation.visitor_type }}</p>
                            <p id="recommend-details-user"><i class="fas fa-comment"></i> {{ recommendation.details }}</p>
                            <hr>
                            <p> Created By: </i> {{ recommendation.created_by }}</p>
                            <br>
                            <!-- 
                                At this point all user recommendations are showing on the user page. 
                                Until filter in place, edit is restricted to the user 
                            -->
                            {% if session.user|lower == recommendation.created_by|lower %}
                                <a href="{{ url_for('edit_recommendations', recommendation_id=recommendation._id) }}"
                                    class="btn">Edit</a>
                                <!-- Modal Trigger To ask User to confirm before deletion happens-->
                                <a class="btn modal-trigger" href="#modal1">Delete</a>

                                <!-- Modal Structure -->
                                <div id="modal1" class="modal">
                                    <div class="modal-content">
                                        <a href="{{ url_for('user_page', username=session['user'])}}!"
                                            class="modal-close btn-flat">Dismiss </a>
                                        <a href="{{ url_for('delete_recommendation', recommendation_id=recommendation._id) }}"
                                            class="modal-close btn-flat">Confirm Deleteion</a>

                                    </div>
                                </div>
                            {% endif %}
                        </div>
                        <!-- closing card content div -->
                    </div>
                    <!-- closing card div -->
                </div>
                {% endif %}
            {% endfor %}
        </div>
        <!-- end of row for cards -->
    </div>
    <!-- end of container -->
    {% else %}
        <h3 class="center-align red-text">No Results found</h3>
    {% endif %}





</div>
{% endblock %}